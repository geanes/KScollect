## update.R ##

# Fill the input fields with the values of the selected record in the table
UpdateInputs <- function(data, session) {
  updateTextInput(session, "uid", value = data[["uid"]])
  updateTextInput(session, "medrec", value = data[["medrec"]])
  updateRadioButtons(session, "SEX", selected = as.character(data[["SEX"]]))
  updateTextInput(session, "height_raw", value = data[["height_raw"]])
  updateTextInput(session, "weight_raw", value = data[["weight_raw"]])
  updateTextInput(session, "height", value = data[["height"]])
  updateTextInput(session, "weight", value = data[["weight"]])
  # updateTextInput(session, "collector", value = data[["collector"]])
  # updateTextInput(session, "location", value = data[["location"]])
  updateTextInput(session, "tstamp", value = data[["tstamp"]])
  updateDateInput(session, "birth", value = data[["birth"]])
  updateDateInput(session, "image", value = data[["image"]])
  updateTextInput(session, "aged", value = data[["aged"]])
  updateTextInput(session, "agey", value = data[["agey"]])
  updateTextInput(session, "COD", value = data[["COD"]])
  updateTextInput(session, "MOD", value = data[["MOD"]])
  # long bones
  updateNumericInput(session, "FDL", value = data[["FDL"]])
  updateNumericInput(session, "FMSB", value = data[["FMSB"]])
  updateNumericInput(session, "FDB", value = data[["FDB"]])
  updateNumericInput(session, "FCB", value = data[["FCB"]])
  updateNumericInput(session, "FIB", value = data[["FIB"]])
  updateNumericInput(session, "TDL", value = data[["TDL"]])
  updateNumericInput(session, "TPB", value = data[["TPB"]])
  updateNumericInput(session, "TMSB", value = data[["TMSB"]])
  updateNumericInput(session, "TDB", value = data[["TDB"]])
  updateNumericInput(session, "FBDL", value = data[["FBDL"]])
  updateNumericInput(session, "HDL", value = data[["HDL"]])
  updateNumericInput(session, "HPB", value = data[["HPB"]])
  updateNumericInput(session, "HMSB", value = data[["HMSB"]])
  updateNumericInput(session, "HDB", value = data[["HDB"]])
  updateNumericInput(session, "HCB", value = data[["HCB"]])
  updateNumericInput(session, "HIB", value = data[["HIB"]])
  updateNumericInput(session, "RDL", value = data[["RDL"]])
  updateNumericInput(session, "RPB", value = data[["RPB"]])
  updateNumericInput(session, "RMSB", value = data[["RMSB"]])
  updateNumericInput(session, "RDB", value = data[["RDB"]])
  updateNumericInput(session, "UDL", value = data[["UDL"]])
  updateNumericInput(session, "UMSB", value = data[["UMSB"]])
  # dentition maxillary
  updateNumericInput(session, "max_M1", value = data[["max_M1"]])
  updateSelectInput(session, "max_M1_side", selected = ifelse(!is.na(data[["max_M1_side"]]), as.character(data[["max_M1_side"]]), ""))
  updateNumericInput(session, "max_M2", value = data[["max_M2"]])
  updateSelectInput(session, "max_M2_side", selected = ifelse(!is.na(data[["max_M2_side"]]), as.character(data[["max_M2_side"]]), ""))
  updateNumericInput(session, "max_M3", value = data[["max_M3"]])
  updateSelectInput(session, "max_M3_side", selected = ifelse(!is.na(data[["max_M3_side"]]), as.character(data[["max_M3_side"]]), ""))
  updateNumericInput(session, "max_PM1", value = data[["max_PM1"]])
  updateSelectInput(session, "max_PM1_side", selected = ifelse(!is.na(data[["max_PM1_side"]]), as.character(data[["max_PM1_side"]]), ""))
  updateNumericInput(session, "max_PM2", value = data[["max_PM2"]])
  updateSelectInput(session, "max_PM2_side", selected = ifelse(!is.na(data[["max_PM2_side"]]), as.character(data[["max_PM2_side"]]), ""))
  updateNumericInput(session, "max_C", value = data[["max_C"]])
  updateSelectInput(session, "max_C_side", selected = ifelse(!is.na(data[["max_C_side"]]), as.character(data[["max_C_side"]]), ""))
  updateNumericInput(session, "max_I1", value = data[["max_I1"]])
  updateSelectInput(session, "max_I1_side", selected = ifelse(!is.na(data[["max_I1_side"]]), as.character(data[["max_I1_side"]]), ""))
  updateNumericInput(session, "max_I2", value = data[["max_I2"]])
  updateSelectInput(session, "max_I2_side", selected = ifelse(!is.na(data[["max_I2_side"]]), as.character(data[["max_I2_side"]]), ""))
  # dentition mandibular
  updateNumericInput(session, "man_M1", value = data[["man_M1"]])
  updateSelectInput(session, "man_M1_side", selected = ifelse(!is.na(data[["man_M1_side"]]), as.character(data[["man_M1_side"]]), ""))
  updateNumericInput(session, "man_M2", value = data[["man_M2"]])
  updateSelectInput(session, "man_M2_side", selected = ifelse(!is.na(data[["man_M2_side"]]), as.character(data[["man_M2_side"]]), ""))
  updateNumericInput(session, "man_M3", value = data[["man_M3"]])
  updateSelectInput(session, "man_M3_side", selected = ifelse(!is.na(data[["man_M3_side"]]), as.character(data[["man_M3_side"]]), ""))
  updateNumericInput(session, "man_PM1", value = data[["man_PM1"]])
  updateSelectInput(session, "man_PM1_side", selected = ifelse(!is.na(data[["man_PM1_side"]]), as.character(data[["man_PM1_side"]]), ""))
  updateNumericInput(session, "man_PM2", value = data[["man_PM2"]])
  updateSelectInput(session, "man_PM2_side", selected = ifelse(!is.na(data[["man_PM2_side"]]), as.character(data[["man_PM2_side"]]), ""))
  updateNumericInput(session, "man_C", value = data[["man_C"]])
  updateSelectInput(session, "man_C_side", selected = ifelse(!is.na(data[["man_C_side"]]), as.character(data[["man_C_side"]]), ""))
  updateNumericInput(session, "man_I1", value = data[["man_I1"]])
  updateSelectInput(session, "man_I1_side", selected = ifelse(!is.na(data[["man_I1_side"]]), as.character(data[["man_I1_side"]]), ""))
  updateNumericInput(session, "man_I2", value = data[["man_I2"]])
  updateSelectInput(session, "man_I2_side", selected = ifelse(!is.na(data[["man_I2_side"]]), as.character(data[["man_I2_side"]]), ""))
  # epiphyseal fusion and ossification
  updateSelectInput(session, "FH_EF", selected = ifelse(!is.na(data[["FH_EF"]]), as.character(data[["FH_EF"]]), ""))
  updateSelectInput(session, "FGT_EF", selected = ifelse(!is.na(data[["FGT_EF"]]), as.character(data[["FGT_EF"]]), ""))
  updateSelectInput(session, "FLT_EF", selected = ifelse(!is.na(data[["FLT_EF"]]), as.character(data[["FLT_EF"]]), ""))
  updateSelectInput(session, "FDE_EF", selected = ifelse(!is.na(data[["FDE_EF"]]), as.character(data[["FDE_EF"]]), ""))
  updateSelectInput(session, "TPE_EF", selected = ifelse(!is.na(data[["TPE_EF"]]), as.character(data[["TPE_EF"]]), ""))
  updateSelectInput(session, "TDE_EF", selected = ifelse(!is.na(data[["TDE_EF"]]), as.character(data[["TDE_EF"]]), ""))
  updateSelectInput(session, "FBPE_EF", selected = ifelse(!is.na(data[["FBPE_EF"]]), as.character(data[["FBPE_EF"]]), ""))
  updateSelectInput(session, "FBDE_EF", selected = ifelse(!is.na(data[["FBDE_EF"]]), as.character(data[["FBDE_EF"]]), ""))
  updateSelectInput(session, "HH_Oss", selected = ifelse(!is.na(data[["HH_Oss"]]), as.character(data[["HH_Oss"]]), ""))
  updateSelectInput(session, "HGT_Oss", selected = ifelse(!is.na(data[["HGT_Oss"]]), as.character(data[["HGT_Oss"]]), ""))
  updateSelectInput(session, "HLT_Oss", selected = ifelse(!is.na(data[["HLT_Oss"]]), as.character(data[["HLT_Oss"]]), ""))
  updateSelectInput(session, "HPE_EF", selected = ifelse(!is.na(data[["HPE_EF"]]), as.character(data[["HPE_EF"]]), ""))
  updateSelectInput(session, "HC_Oss", selected = ifelse(!is.na(data[["HC_Oss"]]), as.character(data[["HC_Oss"]]), ""))
  updateSelectInput(session, "HT_Oss", selected = ifelse(!is.na(data[["HT_Oss"]]), as.character(data[["HT_Oss"]]), ""))
  updateSelectInput(session, "HLE_Oss", selected = ifelse(!is.na(data[["HLE_Oss"]]), as.character(data[["HLE_Oss"]]), ""))
  updateSelectInput(session, "HCE1_EF", selected = ifelse(!is.na(data[["HCE1_EF"]]), as.character(data[["HCE1_EF"]]), ""))
  updateSelectInput(session, "HCE2_EF", selected = ifelse(!is.na(data[["HCE2_EF"]]), as.character(data[["HCE2_EF"]]), ""))
  updateSelectInput(session, "HDE_EF", selected = ifelse(!is.na(data[["HDE_EF"]]), as.character(data[["HDE_EF"]]), ""))
  updateSelectInput(session, "HME_EF", selected = ifelse(!is.na(data[["HME_EF"]]), as.character(data[["HME_EF"]]), ""))
  updateSelectInput(session, "RPE_EF", selected = ifelse(!is.na(data[["RPE_EF"]]), as.character(data[["RPE_EF"]]), ""))
  updateSelectInput(session, "RDE_EF", selected = ifelse(!is.na(data[["RDE_EF"]]), as.character(data[["RDE_EF"]]), ""))
  updateSelectInput(session, "UPE_EF", selected = ifelse(!is.na(data[["UPE_EF"]]), as.character(data[["UPE_EF"]]), ""))
  updateSelectInput(session, "UDE_EF", selected = ifelse(!is.na(data[["UDE_EF"]]), as.character(data[["UDE_EF"]]), ""))
  updateSelectInput(session, "CT_EF", selected = ifelse(!is.na(data[["CT_EF"]]), as.character(data[["CT_EF"]]), ""))
  updateSelectInput(session, "CC_Oss", selected = ifelse(!is.na(data[["CC_Oss"]]), as.character(data[["CC_Oss"]]), ""))
  updateSelectInput(session, "TC_Oss", selected = ifelse(!is.na(data[["TC_Oss"]]), as.character(data[["TC_Oss"]]), ""))
  updateSelectInput(session, "ISPR_EF", selected = ifelse(!is.na(data[["ISPR_EF"]]), as.character(data[["ISPR_EF"]]), ""))
  updateSelectInput(session, "ILIS_EF", selected = ifelse(!is.na(data[["ILIS_EF"]]), as.character(data[["ILIS_EF"]]), ""))
  updateSelectInput(session, "PC_Oss", selected = ifelse(!is.na(data[["PC_Oss"]]), as.character(data[["PC_Oss"]]), ""))
}
